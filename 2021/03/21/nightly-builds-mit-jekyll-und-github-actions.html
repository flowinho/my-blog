<!DOCTYPE html>
<html lang="en"><head>
    <title>.devDiary { }</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">    
    <!-- General Opengraph attributes -->
    <meta content=".devDiary { }" property="og:site_name">
    
        <meta content="How-to: Nightly Builds für Jekyll Blogs mit GitHub Actions umsetzen" property="og:title">
    
    
        <meta content="article" property="og:type">
    
    
        <meta content="/2021/03/21/nightly-builds-mit-jekyll-und-github-actions.html" property="og:url">
    

    
        <meta content="2021-03-21T00:00:00+01:00" property="article:published_time">
        <meta content="https://blog.fschuttkowski.xyz/ueber-mich/" property="article:author">
    

    
        <meta content="/assets/posts/2021-03-21-github-action-jekyll.png" property="og:image">
    

    <!-- Post specific Opengraph attributes -->
    
  
  <meta content="~/code" property="article:section">
  


  
  <meta content=".yml" property="article:tag">
  

    
    <!-- End of Opengraph -->

<link rel="apple-touch-icon" sizes="180x180" href="/assets/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/favicons/site.webmanifest">
<link rel="mask-icon" href="/assets/favicons/safari-pinned-tab.svg" color="#51a737">
<link rel="shortcut icon" href="/assets/favicons/favicon.ico">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff"><link rel="stylesheet" href="/assets/main.css">
    <link rel="stylesheet" href="/prism/prism.css">
    <script src="/prism/prism.js"></script>
    <script src="/lazysizes/lazysizes.min.js"></script><link type="application/atom+xml" rel="alternate" href="https://blog.fschuttkowski.xyz/feed.xml" title=".devDiary {     }" /></head>
  <body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">.devDiary {     }</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/ueber-mich/">~/ueber-mich</a><a class="page-link" href="/code/">~/code</a><a class="page-link" href="/jekyll/">~/jekyll</a><a class="page-link" href="/podcast/">~/podcast</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">How-to: Nightly Builds für Jekyll Blogs mit GitHub Actions umsetzen</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2021-03-21T00:00:00+01:00" itemprop="datePublished">Mar 21, 2021
      </time>
      in <span class="nord15"> </span>&nbsp;~/code ~/jekyll
      
      
  <br/><span class="nord12"> </span>&nbsp;[.yml]
    
    </p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>Dieser Post ist eine Art selbst-validierendes Experiment. Geschrieben am 20.03.2021, aber <em>datiert</em> auf den 21.03.2021. Das bedeutet er wird nur im Blog sichtbar, 
wenn heute Nacht, 00:00 GMT+1 die entsprechende GitHub Action aktiv wird und diesen Blog baut. Hoffen wir dass es klappt! 🤞🏻😊</p>

<h2 id="warum-nightly-builds-für-einen-blog">Warum Nightly Builds für einen Blog?</h2>

<p>Die Antwort ist sehr simpel: um Beiträge planen zu können. Jekyll Blogs sind statische Webseiten, die in aller Regel durch einen Githook auf das “Push” Event auf einen Branch, normalerweise <code class="language-plaintext highlighter-rouge">master</code>, gebaut und deployed werden. Statische Webseiten sind deshalb so toll, weil sie über keinerlei Datenbanken oder sonstiges Backends verfügen, die die Auslieferung oder Anzeige der Seite bremsen könnten.</p>

<p>Doch statische Webseiten hab auch Nachteile. So lassen sich beispielsweise ohne Continuous Integration bzw. Nightly Builds keine Beiträge einplanen. Denn selbst wenn ein Post, wie dieser hier, ein zukünftiges Datum trägt, wird die statische Seite nur bei jedem Push gebaut. Wer also nicht jede Nacht manuell einen push durchführen möchte, braucht eine Pipeline, die idealerweise Nachts um 00:00 Uhr oder 03:00 Uhr läuft.</p>

<p>Des weiteren eignen sich Jekyll Builds über GitHub Actions besonders gut für GitHub-Pages, da auf diese Weise die von Microsoft definierten Blacklist von Jekyll-Plugins und Ruby-Gems umgehen werden kann.</p>

<p>Dieser Post wird eine solche Pipeline für einen Jekyll Blog mittels GitHub Actions umsetzen, das Prinzip lässt sich aber auf beliebige Integrations-Services ausweiten.</p>

<h2 id="github-actions--jekyll--️">GitHub Actions + Jekyll = ❤️</h2>

<p>GitHub Actions funktioniert sehr straigtforward mittels einer <code class="language-plaintext highlighter-rouge">.yml</code>-Datei. Wer bereits Berührung mit alternativen Build-Systemen hatte wird diese Form der Konfiguration kennen. Wir starten also in dem wir im Ordner <code class="language-plaintext highlighter-rouge">.github/workflows/</code> eine neue Datei für unsere Action anlegen, beispielsweise <code class="language-plaintext highlighter-rouge">github-pages.yml</code>. Die .yml-Datei für diesen Blog kann <a href="https://github.com/flowinho/my-blog/blob/master/.github/workflows/github-pages.yml">hier</a> eingesehen werden.</p>

<p>Hier nun der kommentierte Inhalt von <code class="language-plaintext highlighter-rouge">github-pages.yml</code>:</p>

<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">name</span><span class="pi">:</span> <span class="s">GitHub Actions Nightly Build</span>

<span class="c1"># Das Keyword `on` definiert das Event welches die Action startet.</span>
<span class="na">on</span><span class="pi">:</span>
  <span class="na">push</span><span class="pi">:</span>                     <span class="c1"># Sobald ein neuer Commit auf einen beliebigen Branch gepushed wurde.</span>
  <span class="na">schedule</span><span class="pi">:</span>                 <span class="c1"># Build mittels cron-Syntax einplanen.</span>
    <span class="pi">-</span> <span class="na">cron</span><span class="pi">:</span> <span class="s2">"</span><span class="s">1</span><span class="nv"> </span><span class="s">6</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*"</span>     <span class="c1"># Morgens, 06:01 Uhr UTC</span>

<span class="c1"># Das Keyword `jobs` definiert die auszuführenden Schritte.</span>
<span class="na">jobs</span><span class="pi">:</span>
  <span class="na">jekyll</span><span class="pi">:</span>
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">ubuntu-16.04</span>   <span class="c1"># Zielsystem, ein Docker-Container.</span>
    <span class="na">steps</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/checkout@v2</span> <span class="c1"># Eine Basis-Action, die es erlaubt Code aus dem Repository </span>
                                <span class="c1"># in dem die Action definiert wurde auszuchecken.</span>

    <span class="c1"># Cached den Container um die Buildzeit drastisch zu verkürzen. Erste Build ca 3min, danach ~40s.</span>
    <span class="pi">-</span> <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/cache@v2</span>
      <span class="na">with</span><span class="pi">:</span>
        <span class="na">path</span><span class="pi">:</span> <span class="s">vendor/bundle</span>
        <span class="na">key</span><span class="pi">:</span> <span class="s">${{ runner.os }}-gems-${{ hashFiles('**/Gemfile') }}</span>
        <span class="na">restore-keys</span><span class="pi">:</span> <span class="pi">|</span>
          <span class="s">${{ runner.os }}-gems-</span>

    <span class="c1"># Der eigentliche Jekyll Build</span>
    <span class="pi">-</span> <span class="na">uses</span><span class="pi">:</span>  <span class="s">helaili/jekyll-action@v2</span>       <span class="c1"># Eine GitHub-Action, gewartet von einem Mitglied des Jekyll-Teams.</span>
      <span class="na">with</span><span class="pi">:</span>                                 <span class="c1"># Das AccessToken um den Build auszuführen.</span>
        <span class="na">token</span><span class="pi">:</span> <span class="s">${{ secrets.GITHUB_TOKEN }}</span>
        <span class="na">target_branch</span><span class="pi">:</span> <span class="s1">'</span><span class="s">gh-pages'</span>           <span class="c1"># Diese Branchspezifikation ist notwendig, um den bestehenden Branch zu überschreiben.</span>
</code></pre></div></div>

<p>Kleines Schmankerl: GitHub Actions zeigt die Auflösung der eingetragenen Cron-Syntax als Popup an.</p>

<p><img src="/assets/posts/2021-03-21-github-actions-cron-popover.png" alt="" /></p>

<p>Nach dem Datei erstellt und befüllt wurde sollten wir sie über “Start Commit” im Webinterface oder einen <code class="language-plaintext highlighter-rouge">git push</code> ins Repository speichern. Dieser Vorgang führt auch gleich zu einer initialen Ausführung der Action.</p>

<p>Wer die Actions die diesen Blog bauen in Aktion sehen möchte, kann sie jederzeit gerne <a href="https://github.com/flowinho/my-blog/actions/runs/672710303">hier</a> betrachten.</p>

<p>Zurücklehnen und genießen!</p>

<p><img src="/assets/posts/2021-03-21-github-action-jekyll.png" alt="" /></p>

<p>Nun muss noch ein evtl. bestehendes GitHub-Pages Environment vom Repository entfernt werden, damit die Action genutzt wird, und nicht das default Environment.</p>

<p>Und wenn alles geklappt hat,  taucht dieser Post morgen in meinem devDiary auf! 🖖🏻</p>

  </div><a class="u-url" href="/2021/03/21/nightly-builds-mit-jekyll-und-github-actions.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">
    <h2 class="footer-heading">.devDiary {     }</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Florian Schuttkowski</li><li><a class="u-email" href="mailto:contact [at] flowinho [com]">contact [at] flowinho [com]</a></li></ul>
        <p><a href="/impressum/">~/impressum</a><br /><a href="/datenschutz/">~/datenschutz</a></p>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/flowinho"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">flowinho</span></a></li><li><a href="https://www.twitter.com/flowinho"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">flowinho</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Durch meine Arbeit an verschiedensten Projekten lerne ich das Eine oder Andere. In meiner Freizeit werfe ich diese Elemente hier rein, zur späteren Referenzierung und zu eurer Unterhaltung.</p>
        <p>Gewidmet meinen wundervollen Kindern. ♥️</p>
      </div>
    </div>

    <div class="technical-info-message nord2">
      Umgesetzt mit <span class=""></span> <a href="https://jekyllrb.com/">jekyll</a>, <span class=""></span> <a href="https://de.wikipedia.org/wiki/Sass_(Stylesheet-Sprache)">scss</a> <span class=""></span> <a href="https://www.ruby-lang.org/en/">ruby</a>, <span class=""></span> <a href="https://prismjs.com/">prismjs</a>, <span class="">ﯔ</span> <a href="https://www.nerdfonts.com/">nerdfonts</a>, <span class=""></span> <a href="https://realfavicongenerator.net"> realfavicon</a>, entwickelt unter  macOS und  xubuntu mit  <a href="https://vscodium.com/">VSCodium</a>, gehostet  <a href="https://github.com/flowinho/my-blog">Open-Source</a> deployed mit ﯙ<a href="https://github.com/flowinho/my-blog/actions">&nbsp;GitHub Actions</a> auf ﯙ <a href="https://github.com/">GitHub</a>, gesichert mit  <a href="https://letsencrypt.org/">Let's Encrypt</a>.
    </div>
  </div>

</footer></body>
</html>
